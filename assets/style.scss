@tailwind base;
@tailwind components;
@tailwind utilities;

@font-face {
  font-family: "Finlandica";
  src: url("chrome-extension://__MSG_@@extension_id__/assets/Finlandica.ttf") format("truetype");
}

// #region Mixins

@mixin shadow {
  box-shadow: 0px 0px 2rem hsla(0, 0%, 0%, 0.1) !important;
}
@mixin card {
  @apply bg-gray-925 rounded-lg border-2 border-gray-900 #{!important};
  &.rounded {
    @apply rounded-lg #{!important};
  }
}
@mixin notificationBadge {
  @apply bg-purple-500 text-white rounded-full top-0 w-5 h-5 items-center justify-center text-xs text-center #{!important};
  &[class*="hidden"] {
    @apply hidden #{!important};
  }
}
@mixin cell {
  @apply border-2 border-gray-950 #{!important};
  // RED
  &[style*="\#FF3300"] {
    @apply bg-purple-500/20 relative hover:bg-purple-500/50 #{!important};
    // HOURGLASS
    &[style*="sandglass"] {
      @apply relative bg-none #{!important};
      &::after {
        animation: hourglass 4s infinite normal ease-in-out;
        @apply content-["⏳"] absolute flex items-center justify-center inset-0 pointer-events-none #{!important};
        @keyframes hourglass {
          0%,
          25% {
            rotate: 0deg;
          }
          25%,
          50% {
            rotate: 180deg;
          }
          50%,
          75% {
            rotate: 180deg;
          }
          75%,
          100% {
            rotate: 360deg;
          }
        }
      }
    }
  }
  // YELLOW
  &[style*="\#F7FE2E"] {
    @apply relative bg-purple-500/20 duration-100 hover:bg-purple-500/50 #{!important};
    a {
      @apply stack #{!important};
    }
    &::after {
      animation: yellowCell 2s infinite alternate ease-in-out;
      @apply absolute inset-x-0 bottom-0 content-[""] h-[20%] pointer-events-none bg-purple-500 #{!important};
      @keyframes yellowCell {
        0% {
          filter: opacity(0.3);
        }
        100% {
          filter: opacity(0.85);
        }
      }
    }
  }
  // GREEN
  &[style*="\#33CC00"] {
    @apply relative bg-purple-500 bg-none #{!important};
    &[style*="up\.png"] {
      &::after {
        @apply content-["👍"] absolute flex items-center justify-center inset-0 pointer-events-none #{!important};
      }
    }
    &[style*="down\.png"] {
      &::after {
        @apply content-["👎"] absolute flex items-center justify-center inset-0 pointer-events-none #{!important};
      }
    }
  }
  // GRAY / FORUMS
  &[style*="#CCCCCC"] {
    @apply bg-gray-900 border-2 border-gray-950 #{!important};
  }
  a {
    @apply rounded-sm outline-purple-500 #{!important};
    &.highlighted {
      @apply outline-2 #{!important};
    }
  }
}
@mixin importantButton {
  @apply bg-gray-900 border-2 border-gray-800 px-6 h-12 flex items-center justify-center hover:bg-gray-800 #{!important};
}
@mixin linkAnchor {
  @include card;
  @apply py-1 px-2 font-medium text-gray-200 hover:brightness-125 #{!important};
  &::before {
    @apply mr-1 h-full aspect-square content-["🔗"] #{!important};
  }
}
@mixin smoothAppearAnim($move: true) {
  animation: smoothAppear 0.1s ease-in-out;
  @keyframes smoothAppear {
    0% {
      opacity: 0;
      @if #{$move} {
        translate: 0 -1rem;
      }
    }
    100% {
      opacity: 1;
      @if #{$move} {
        translate: 0 0;
      }
    }
  }
}
@mixin pulseAnim {
  animation: pulse 1s infinite alternate ease-in-out;
  @keyframes pulse {
    0% {
      opacity: 0.5;
    }
    100% {
      opacity: 1;
    }
  }
}
@mixin prettyMarkdown {
  &,
  * {
    @apply text-gray-400 #{!important};
  }
  strong,
  b {
    @apply text-gray-200 #{!important};
  }
  h1,
  h2,
  h3 {
    @apply mb-8 mt-12 font-medium #{!important};
    * {
      @apply text-xl #{!important};
    }
  }
  a[href] {
    @include linkAnchor;
  }
  pre {
    @apply bg-gray-950 p-4 font-mono font-medium text-gray-400 #{!important};
  }
  ul,
  ol {
    @apply list-inside #{!important};
    * {
      @apply bg-transparent #{!important};
    }
  }
  ul {
    @apply list-disc #{!important};
  }
  ol {
    @apply list-decimal #{!important};
  }
  table {
    @apply mb-4 border-2 rounded-lg border-gray-800 border-separate #{!important};
    caption {
      @apply text-gray-400 font-normal text-sm p-0 my-2 #{!important};
    }
    th:first-of-type {
      @apply rounded-tl-md #{!important};
    }
    th:last-of-type {
      @apply rounded-tr-md #{!important};
    }
    tr:last-of-type td:first-of-type {
      @apply rounded-bl-md #{!important};
    }
    tr:last-of-type td:last-of-type {
      @apply rounded-br-md #{!important};
    }
    thead {
      th {
        @apply bg-gray-900 font-medium text-gray-200 #{!important};
      }
    }
    th,
    td {
      @apply p-2 #{!important};
    }
    tbody {
      tr:nth-child(odd) {
        @apply bg-gray-925 #{!important};
      }
    }
  }
  .contentwithoutlink,
  .mod-indent-outer,
  .img-text,
  .summary {
    @apply m-0 p-0 #{!important};
  }
}

// #endregion

html {
  @apply [scrollbar-gutter:stable] #{!important};
}
body {
  @apply bg-gray-950 font-["Finlandica"] text-gray-400 max-w-none #{!important};
}
/* APPLY FONT SO ICONS DO NOT BREAK */
footer#page-footer {
  @apply bg-black #{!important};
}
/* SLIDER */
::-webkit-scrollbar {
  @apply w-3 h-3 rounded-lg #{!important};
}
::-webkit-scrollbar-thumb {
  @apply bg-gray-900 rounded-lg #{!important};
}
::-webkit-scrollbar-corner {
  @apply hidden #{!important};
}
*,
*:active,
*:focus {
  @apply text-base border-0 border-solid outline-0 outline #{!important};
}
::selection {
  @apply bg-gray-700 text-gray-200 #{!important};
}
*:focus-visible:not(input) {
  @apply outline outline-4 outline-purple-500 duration-100 rounded-[inherit];
}
header#page-header {
  display: none !important;
}
section {
  &.block {
    @apply rounded-lg #{!important};
  }
  &.block_mycourses {
    @apply outline-none #{!important};
  }
  // OUTER LINKS / SPRAVKA ZACHETKA
  &.block_html:has(a[href*="spravka"]) {
    * {
      margin: 0 !important;
    }
    .no-overflow {
      overflow: visible !important;
      h4 {
        @apply flex flex-wrap gap-3 #{!important};
        a {
          @include linkAnchor;
        }
      }
    }
  }
  // MY TEACHERS
  &.block_myteachers {
    div:has(> img, > a) {
      @apply #{!important};
      @apply flex flex-nowrap gap-1 items-center #{!important};
      * {
        @apply m-0 #{!important};
      }
      > img {
        @apply rounded-full w-6 h-6 #{!important};
      }
      > a {
        @apply px-1 py-2 #{!important};
      }
    }
  }
  // ONLINE USERS
  &.block_online_users {
    ul {
      > li {
        @apply flex gap-1 items-center #{!important};
        > .user {
          @apply flex #{!important};
          > a {
            @apply py-1 px-2 #{!important};
          }
        }
        > .message {
          @apply m-0 #{!important};
          > a {
            @apply p-1 #{!important};
            &:hover,
            &:focus,
            &:active {
              @apply bg-transparent #{!important};
              > i::before {
                @apply text-gray-400 #{!important};
              }
            }
            > i {
              @apply m-0 #{!important};
            }
          }
        }
      }
    }
  }
  // ACTIVITY / COURSE ELEMENTS
  &.block_activity_modules {
    ul {
      @apply flex flex-col gap-2 #{!important};
      li div {
        @apply flex #{!important};
        display: flex !important;
        a {
          @apply h-10 flex px-3 hover:brightness-125 items-center gap-2 border-2 border-gray-800 #{!important};
        }
      }
    }
  }
}
.alert {
  @apply rounded-lg text-center #{!important};
  &-danger {
    @apply bg-rose-500/10 text-rose-500 #{!important};
  }
  &-info {
    @apply bg-blue-500/10 text-blue-500 #{!important};
  }
  &-warning {
    @apply bg-orange-500/10 text-orange-500 #{!important};
  }
}
.text-danger,
i.fa-exclamation-circle.text-danger,
.invalid-feedback {
  @apply text-rose-500 #{!important};
}
/* DROPDOWN MENUS */
.dropdown-menu {
  @include card;
  @include shadow;
  @include smoothAppearAnim;
  li a {
    @apply rounded-lg p-1 #{!important};
  }
  .show {
    @apply bg-gray-950 rounded-lg p-2 #{!important};
  }
}
.popover-region-container {
  @include card;
  @include shadow;
  @include smoothAppearAnim;
  @apply p-2 bg-gray-925 #{!important};
}
.icon {
  @apply w-auto h-auto #{!important};
}
// Placeholders while the content is loading.
[data-region="placeholder-container"],
[data-region="header-placeholder"] {
  > * {
    @apply bg-transparent #{!important};
    .bg-pulse-grey {
      @apply bg-gray-900 animate-pulse #{!important};
    }
  }
}
#page-wrapper {
  // POPUP NAV LEFT / COMPACT NAVBAR
  > #nav-drawer {
    @apply bg-gray-950 inset-y-0 #{!important};
  }
  // NAVBAR
  > nav.navbar.fixed-top {
    @apply bg-transparent relative flex items-center my-10 mx-4 p-0 shadow-none max-h-[initial] #{!important};
    // LEFT HAMBURGER
    [data-region="drawer-toggle"] {
      @apply w-8 h-8 rounded-lg mr-6 border-2 border-gray-900 hover:border-gray-800 #{!important};
      button:has(i.fa-bars) {
        @apply flex p-0 h-full aspect-square justify-center items-center text-gray-400 hover:text-gray-200 m-0 #{!important};
        i {
          @apply flex w-full h-full items-center justify-center #{!important};
          &::before {
            @apply #{!important};
          }
        }
      }
    }
    a.navbar-brand,
    span.site-name,
    ul li a {
      @apply text-gray-400 hover:text-gray-200 #{!important};
    }
    a.navbar-brand {
      mask: url("chrome-extension://__MSG_@@extension_id__/assets/home.svg");
      @apply w-7 h-7 relative bg-gray-400 hover:bg-gray-200 #{!important};
      > span {
        @apply hidden #{!important};
      }
    }
    ul:nth-child(3) {
      @media (max-width: 1140px) {
        @apply hidden #{!important};
      }
    }
    // PROFILE IN NAV
    .nav.usernav {
      @apply flex-nowrap items-center #{!important};
      #nav-notification-popover-container {
        // BELL BUTTON / ICON
        .popover-region-toggle.nav-link {
          @apply shadow-none text-gray-400 hover:text-gray-200 after:hidden before:hidden #{!important};
        }
        // Notifications popover.
        .popover-region-container {
          @apply flex flex-col top-10 #{!important};
          .popover-region-header-container {
            @apply p-0 flex items-center h-auto #{!important};
            .popover-region-header-actions {
              @apply ml-auto flex gap-2 #{!important};
              a {
                @apply m-0 p-0 h-8 w-8 flex items-center justify-center bg-gray-900 hover:bg-gray-800 #{!important};
                i {
                  @apply m-0 #{!important};
                }
              }
            }
          }
          // List of notifications.
          .popover-region-content-container {
            @apply h-auto flex-1 #{!important};
          }
          a.see-all-link {
            @apply bg-gray-900 rounded-lg block hover:bg-gray-800 #{!important};
            > div {
              @apply bg-transparent #{!important};
            }
          }
        }
      }
      a#action-menu-toggle-1 {
        @apply p-0 #{!important};
        &[aria-expanded="true"] .usertext::after {
          @apply rotate-180 #{!important};
        }
        &:hover .userbutton .usertext {
          @apply text-gray-200 #{!important};
        }
        .userbutton {
          @include card;
          @apply flex flex-row-reverse items-center gap-3 px-3 h-12 hover:border-gray-800 #{!important};
          > .avatars img {
            @apply m-0 shrink-0 w-8 h-8 #{!important};
          }
          .usertext {
            @apply text-gray-300 items-center m-0 #{!important};
            &::after {
              @apply content-["▾"] ml-2 text-gray-400 text-2xl duration-200 ease-out #{!important};
            }
          }
        }
        .caret,
        &::after {
          @apply hidden #{!important};
        }
      }
      // NEW MESSAGES OR NOTIFICATIONS NUMBER
      .count-container {
        @include pulseAnim;
        @include notificationBadge;
      }
    }
  }
}
// Modal messenger, compact messenger.
[data-origin^="message-drawer-toggle"],
[data-origin^="message-user-button"] {
  &.bg-white {
    @include smoothAppearAnim;
    @apply fixed inset-0 w-full h-full bg-black/50 backdrop-blur-[2px] flex items-center justify-center z-[1031] #{!important};
  }
  & .message-app {
    @apply h-[calc(100%-2rem)] w-[calc(100vw-2rem)] max-w-screen-md flex #{!important};
  }
  & .closewidget {
    @apply bg-transparent justify-end flex #{!important};
    & a[data-action="closedrawer"] {
      @apply self-end m-0 bg-transparent h-10 w-10 border-2 border-solid border-gray-900 hover:border-gray-800 rounded-lg #{!important};
      & i {
        @apply w-full h-full flex items-center justify-center #{!important};
        &::before {
          @apply text-gray-300 content-["\2573"] #{!important};
        }
      }
    }
  }
}
// PARTICIPANTS
div[data-table-region^="user-index-participants"] {
  @include card;
  @include shadow;
  @apply p-4 #{!important};
  & .border-radius.bg-white {
    @apply border-none bg-gray-900 rounded-lg p-4 #{!important};
  }
}
/* BUTTONS AND LINKS / SELECT */
button.nav-link.float-sm-left.bg-gray {
  @apply bg-transparent hover:brightness-125 #{!important};
}
button,
a {
  @apply bg-transparent rounded-lg shadow-none [text-decoration:none] focus-visible:outline-2 outline-purple-500 text-gray-300 hover:text-gray-200 #{!important};
  &:disabled,
  &.page-link {
    @apply bg-transparent #{!important};
  }
  i.icon.text-info {
    @apply m-0 text-purple-500 hover:text-purple-400 #{!important};
  }
}
select {
  @apply h-12 flex items-center px-3 rounded-lg text-gray-200 bg-gray-900 shadow-none focus-visible:outline-2 outline-purple-500 #{!important};
}
.aalink.focus,
#page-footer a:not([class]).focus,
.arrow_link.focus,
a:not([class]).focus,
.activityinstance > a.focus,
.aalink:focus,
#page-footer a:not([class]):focus,
.arrow_link:focus,
a:not([class]):focus,
.activityinstance > a:focus {
  box-shadow: none !important;
  background-color: transparent !important;
}
.card {
  @include shadow;
  @include card;
}
//GO TO TOP BUTTON
div#goto-top-link > a {
  @apply flex justify-center items-center mr-4 bg-gray-925 w-12 h-12 rounded-full outline-2 outline-gray-800 opacity-50 hover:opacity-100 p-0 #{!important};
  > i {
    @apply m-0 w-auto h-auto #{!important};
  }
}
// TABLES
table.generaltable:not(.course-box),
.course-content table,
table.preference-table,
table#user-grades {
  @apply bg-gray-925 overflow-hidden rounded-lg outline-2 outline-gray-800 #{!important};
  > tbody {
    tr:nth-child(odd) {
      @apply bg-gray-900/50 #{!important};
    }
  }
  & th,
  & td {
    @apply p-3 #{!important};
  }
  & * {
    @apply text-gray-400 bg-transparent #{!important};
  }
  & a {
    @apply text-gray-400 hover:text-gray-200 #{!important};
  }
}
// MARKDOWN HTML TEXT ANSWER
[class*="assignsubmission_onlinetext"]:has(> .no-overflow) {
  @include card;
  @apply bg-transparent p-4 #{!important};
  > .no-overflow {
    @include prettyMarkdown;
    @apply overflow-visible mt-4 #{!important};
  }
}
// INPUT / SEARCH / SUBMIT
input {
  @apply bg-gray-900 py-3 px-4 shadow-none text-gray-200 focus:outline-2 outline-gray-700 rounded-lg accent-purple-500 #{!important};
  &.form-control {
    @apply bg-gray-900 #{!important};
  }
  &[type="checkbox"],
  &[type="radio"] {
    @apply w-4 h-4 #{!important};
  }
}
// DIV WITH CHECKBOX AND LABEL / RADIO AND LABEL
div:has(> input[type="checkbox"]):has(> label[for]),
div:has(> label) {
  @apply flex flex-nowrap gap-2 items-center #{!important};
  > label {
    @apply text-gray-200 cursor-pointer #{!important};
    &:has(> input) {
      @apply flex flex-nowrap gap-2 items-center #{!important};
    }
  }
  * {
    @apply m-0 #{!important};
  }
}
button.btn,
input.btn {
  @apply font-medium rounded-lg hover:brightness-125 #{!important};
}
button.btn-primary,
input.btn-primary {
  @apply py-3 px-6 bg-purple-500 text-white #{!important};
}
button.btn-secondary,
input.btn-secondary {
  @apply bg-gray-900 py-3 px-6 text-gray-400 #{!important};
}
button.btn-submit {
  @apply bg-transparent #{!important};
}
// TEXT EDITOR
textarea,
// #id_assignfeedbackcomments_editoreditable,
// #id_onlinetext_editoreditable,
// #id_description_editoreditable,
[id*=editoreditable] {
  @include prettyMarkdown;
  @apply bg-gray-950 rounded-lg p-1 text-gray-200 shadow-none focus:outline-2 active:outline-2 outline-purple-500 #{!important};
  &.bg-light {
    @apply bg-inherit border-inherit #{!important};
  }
}
.editor_atto_wrap {
  @apply bg-gray-950 p-2 rounded-lg #{!important};
  .editor_atto {
    .editor_atto_toolbar {
      @apply bg-transparent #{!important};
      .atto_group {
        @apply bg-transparent rounded-lg overflow-hidden #{!important};
        button {
          @apply bg-gray-900 rounded-none hover:bg-gray-800 [background-image:none] #{!important};
          i {
            @apply text-gray-400 #{!important};
          }
        }
      }
    }
    .editor_atto_content_wrap {
      @apply bg-transparent #{!important};
      .editor_atto_content {
        @apply p-3 #{!important};
      }
    }
  }
  .editor_atto_notification {
    @apply mt-2 #{!important};
    .atto_info {
      @apply bg-gray-900 rounded-lg px-4 py-2 text-sm flex items-center gap-2 #{!important};
    }
  }
}
// POPOVER / POPUP
.popover {
  @include card;
  @include shadow;
  @include smoothAppearAnim;
  transition: transform 0s !important;
  * {
    @apply text-gray-300 bg-transparent font-["Finlandica"] #{!important};
  }
  .popover-header {
    @apply bg-gray-900 rounded-t-lg text-sm #{!important};
  }
  .popover-body,
  .popover-body * {
    @apply text-sm #{!important};
  }
  div::after,
  div::before {
    @apply hidden #{!important};
  }
}
// CALENDER
td.hasevent {
  @apply bg-gray-925 hover:bg-gray-900 #{!important};
  a {
    @apply rounded-none hover:bg-transparent #{!important};
  }
}
// SUBJECTS AND COURSES TABLES
.card-text.content {
  > .customtitle,
  > .legend-box {
    display: none !important;
  }
  // EACH SUBJECT OR COURSE
  > div:has(table.course-box) {
    @apply mt-8 #{!important};
    // SUBJECT NAME
    > h3 > a {
      @apply flex py-2 hover:brightness-125 hover:text-gray-200 font-medium text-lg #{!important};
    }
    & .course-box {
      @apply overflow-hidden rounded-lg #{!important};
      & > tbody {
        @apply w-auto bg-gray-950 #{!important};
        .activeness {
          @apply hidden #{!important};
        }
        // CELLS BACKGROUND
        & > tr > td {
          @apply p-4 bg-transparent #{!important};
        }
        .progressbox {
          .progressbar {
            // EACH CELL
            & td.cm {
              @include cell;
            }
            & tbody tr span {
              display: none;
            }
          }
          .generalinfobox {
            @apply hidden #{!important};
          }
          // GO TO TEST / TASK / FORUM
          .cminfobox {
            margin-top: 0.5rem !important;
            span.cminfoboxcontent {
              @include smoothAppearAnim(false);
              @apply flex w-fit h-fit py-1 px-2 bg-gray-900 rounded-lg hover:bg-gray-925 #{!important};
              a {
                @apply text-sm hover:bg-transparent #{!important};
              }
            }
            a.closeinfobox {
              @apply h-6 text-center aspect-square #{!important};
            }
          }
        }
      }
      // Teacher course with students groups or without groups.
      &:has(.group-box),
      & td:has(> :last-child:nth-child(4)) {
        // If no groups.
        &:not(:has(> .group-box)) {
          & > :nth-child(2) {
            @apply mb-2 #{!important};
          }
        }
        // Course name.
        .course-info {
          @apply mb-2 #{!important};
          h3 {
            @apply mb-2 #{!important};
            a.course-name {
              @apply [text-decoration:none] font-medium text-lg #{!important};
            }
          }
          > :nth-child(2) {
            a {
              @apply underline underline-offset-2 #{!important};
            }
          }
        }
        a.manage-link {
          @apply bg-gray-900 hover:bg-gray-800 px-3 py-1 rounded-lg mr-2 #{!important};
        }
        // Each group of students.
        .group-box {
          @apply rounded-lg border-2 border-gray-900 p-2 flex gap-2 #{!important};
          > .group-status-box {
            @apply flex w-32 #{!important};
            .group-status {
              @apply px-2 flex items-center justify-center flex-col gap-1 rounded-lg flex-1 #{!important};
              &.group-idle {
                @apply bg-rose-500/10 text-rose-500 #{!important};
              }
              &.group-completion {
                @apply bg-gray-925 text-gray-400 #{!important};
                .group-completion-value {
                  @apply text-gray-200 font-medium text-lg #{!important};
                }
              }
            }
          }
          > .group-completion-box {
            @apply flex flex-col gap-2 flex-nowrap m-0 flex-1 #{!important};
            // Top.
            > :nth-child(1) {
              @apply flex flex-row gap-2 #{!important};
              > * {
                @apply p-0 #{!important};
              }
              // Group name.
              > :nth-child(1) {
                @apply mr-auto #{!important};
              }
              a > img {
                @apply hidden #{!important};
              }
              a[href*="delete"] {
                @apply text-gray-500 hover:text-rose-700 #{!important};
              }
            }
            // Completion slider, group completed task slider.
            > :nth-child(2) {
              @apply m-0 #{!important};
            }
            // BOTTOM
            > :nth-child(3) {
              @apply gap-2 flex-row flex #{!important};
              > * {
                @apply p-0 #{!important};
              }
              // SEND MESSAGE TO GROUP
              span,
              a[href*="message"] {
                > img {
                  @apply hidden #{!important};
                }
              }
            }
          }
        }
        // BOTTOM
        a {
          // ADD GROUP
          &:has(> img[src$="group"]) {
            > img {
              display: none !important;
            }
          }
          // ADD SINGLE STUDENT
          &:has(> img[src$="user"]) {
            > img {
              display: none !important;
            }
          }
        }
      }
    }
  }
}

// MAIN BLOCK / SUBJECTS / SUBJECT PAGE

#page {
  @apply my-0 p-0 px-4 #{!important};
}
body {
  // LOGIN
  &#page-login-index {
    section#region-main {
      @apply bg-none shadow-none outline-none #{!important};
      .card {
        @apply bg-gray-925 p-4 rounded-md #{!important};
        h1.card-header {
          @apply text-gray-300 font-medium #{!important};
        }
      }
    }
    button#loginbtn {
      @include importantButton;
    }
    .forgetpass {
      a {
        @apply [text-inset:0] px-3 py-1 text-sm border-2 border-gray-800 block w-fit #{!important};
      }
      & + div {
        @apply text-sm #{!important};
      }
    }
  }
  &#page-my-index {
    // Recently accessed courses.
    section.block_recentlyaccessedcourses {
      .card-text.content {
        @apply m-0 #{!important};
        [data-region="loading-placeholder"] {
          @apply mt-14 #{!important};
          .card-deck {
            @apply h-auto flex justify-center #{!important};
            .card {
              @apply m-0 h-44 w-auto grow #{!important};
              &:not(:nth-child(1)) {
                @apply hidden #{!important};
              }
              .card-img-top {
                @apply bg-gray-800 animate-pulse rounded-lg h-full #{!important};
              }
              .card-body {
                @apply hidden #{!important};
              }
            }
          }
        }
        [data-region="view-content"] {
          .paging-bar-container ul {
            @apply gap-2 #{!important};
            li {
              &.disabled {
                @apply opacity-50 #{!important};
              }
              a.page-link {
                @apply h-10 w-10 rounded-lg bg-gray-900 hover:bg-gray-800 flex items-center justify-center #{!important};
              }
            }
          }
          .card-deck {
            @apply gap-4 #{!important};
            .card {
              @apply h-44 flex flex-col m-0 w-auto grow #{!important};
              a {
                @apply h-auto grow #{!important};
                .card-img {
                  @apply h-full rounded-t-lg #{!important};
                }
              }
              .card-body {
                @apply flex-none min-h-0 p-3 #{!important};
                .text-truncate > :nth-child(1) {
                  @apply text-sm m-0 #{!important};
                }
              }
            }
          }
        }
      }
    }
    section.block_timeline [data-region="timeline"] {
      // Sorting buttons.
      > :nth-child(1) {
        @apply border-0 p-0 #{!important};
        button {
          @apply bg-gray-900 hover:bg-gray-800 rounded-md #{!important};
        }
      }
      // Timeline loading.
      [data-region="event-list-loading-placeholder"] {
        @apply mt-4 #{!important};
        ul {
          @apply gap-2 #{!important};
          li {
            @apply rounded-lg bg-gray-900 animate-pulse h-12 #{!important};
            * {
              @apply hidden #{!important};
            }
          }
        }
        > :nth-child(2) {
          @apply hidden #{!important};
        }
      }
      // Stale tasks.
      [data-region="paged-content-page"] > :nth-child(1) {
        @apply border-0 p-0 #{!important};
        h5 {
          @apply text-rose-500 my-2 text-sm #{!important};
        }
        .list-group {
          @apply gap-2 #{!important};
          .list-group-item {
            @apply p-3 rounded-lg bg-gray-900 #{!important};
            > :nth-child(1) {
              @apply gap-2 #{!important};
              a h6 {
                @apply text-gray-400 hover:text-gray-200 font-medium #{!important};
              }
              small {
                @apply text-gray-500 text-sm #{!important};
              }
              // Add answer.
              a[href*="editsubmission"] {
                @apply border-2 border-gray-800 hover:border-gray-700 flex py-1 px-3 rounded-md text-sm text-gray-200 w-fit #{!important};
              }
            }
          }
        }
      }
    }
  }
  &#page-mod-assign-view,
  &#page-mod-assign-editsubmission,
  &#page-mod-quiz-view {
    [role="main"] {
      > h2 {
        @apply text-lg text-gray-200 #{!important};
      }
      #intro {
        @include prettyMarkdown;
      }
    }
    // Audio, text file attached.
    [id*="assign_files_tree"] {
      td:has(> .ygtvspacer) {
        @apply hidden #{!important};
      }
      .fileuploadsubmission {
        @apply flex items-center gap-2 #{!important};
        img {
          @apply m-1 #{!important};
        }
      }
      .fileuploadsubmissiontime {
        @apply text-sm #{!important};
      }
    }
    .activity-navigation {
      @apply mx-0 mb-0 mt-8 p-0 #{!important};
      > :nth-child(1) {
        @apply max-md:block m-0 flex-nowrap gap-4 #{!important};
        .col-md-4 {
          @apply p-0 w-auto flex-[1] max-w-none #{!important};
          > :nth-child(1) {
            @apply float-none #{!important};
          }
          &:nth-child(1) a {
            @apply text-start block #{!important};
          }
          &:has(select) {
            @apply flex-[2] #{!important};
          }
          &:nth-child(3) a {
            @apply text-end block #{!important};
          }
        }
      }
      #prev-activity-link,
      #next-activity-link {
        @apply text-sm text-gray-300 hover:text-gray-200 p-1 [text-wrap:balance] #{!important};
      }
      select {
        @apply w-auto #{!important};
      }
    }
  }
  // Confirm the sending of the answer.
  &#page-mod-assign-submit {
    .submitforgrading {
      @apply p-4 rounded-lg border-2 border-purple-500 #{!important};
      h3 {
        @apply text-gray-200 mb-3 #{!important};
      }
      form {
        @apply p-0 #{!important};
        .form-group {
          @apply m-0 #{!important};
        }
        .col-md-9 {
          @apply p-0 flex-auto max-w-none #{!important};
        }
        #fitem_id_confirmmessage {
          @apply flex-nowrap mb-3 #{!important};
          > :nth-child(1) {
            @apply hidden #{!important};
          }
        }
        // Continue, cancel buttons.
        #fgroup_id_buttonar {
          > :nth-child(1) {
            @apply hidden #{!important};
          }
          :has(> .form-group) {
            @apply justify-end gap-2 #{!important};
            .form-group {
              @apply m-0 #{!important};
            }
          }
        }
      }
    }
  }
  &#page-mod-assign-editsubmission {
    .editsubmissionform {
      form {
        @apply m-0 p-0 #{!important};
        .form-group {
          @apply m-0 my-4 gap-4 flex-nowrap items-start flex-row max-md:block #{!important};
          .col-form-label {
            @apply p-0 max-md:mb-4 #{!important};
          }
          .form-inline {
            @apply p-0 flex-auto #{!important};
          }
        }
        .btn-cancel {
          @apply ml-2 #{!important};
        }
      }
    }
  }
  &:not(#page-login-index, #page-my-index) div#region-main-box > section#region-main {
    @include shadow;
    @include card;
    @apply max-md:p-4 #{!important};
    span#maincontent {
      display: none !important;
    }
    .course-content {
      @include prettyMarkdown;
      .no-overflow {
        @apply overflow-visible #{!important};
      }
      a.aalink {
        @apply flex items-center gap-2 [text-indent:0] #{!important};
        img {
          @apply w-8 h-auto p-1 aspect-square #{!important};
        }
      }
    }
  }
  // USER PROFILE / YOU OR SOMEBODY ELSE
  &#page-user-profile {
    .userprofile {
      //TOP PICTURE AND BUTTONS ADD TO CONTACTS AND WRITE A MESSAGE
      .page-context-header {
        @apply items-center flex-wrap gap-4 mb-4 p-0 inline-flex #{!important};
        .page-header-image {
          @apply m-0 #{!important};
          img.userpicture {
            @apply m-0 #{!important};
          }
        }
        .page-header-headings {
          display: inline-flex !important;
          & > h2 {
            @apply m-0 #{!important};
          }
        }
        .header-button-group {
          @apply gap-4 flex-nowrap inline-flex #{!important};
          & > a {
            @include importantButton;
          }
        }
      }
      .profile_tree {
        a[href*="user\/edit"] {
          @include importantButton;
        }
        a[href*="mailto"] {
          @include linkAnchor;
          @apply mt-4 flex #{!important};
        }
        a {
          @apply p-2 #{!important};
        }
        ul {
          @apply gap-1 flex-col flex #{!important};
          &.inline-list {
            @apply flex-wrap flex-row inline-flex #{!important};
          }
          li {
            @apply flex #{!important};
            span {
              @apply flex #{!important};
            }
          }
        }
      }
    }
  }
  // USER PREFERENCES
  &#page-user-preferences {
    [role="main"] {
      .card {
        display: flex !important;
        width: fit-content !important;
        .card-body:has(> h4, > div) {
          display: flex !important;
          flex-direction: column !important;
          width: fit-content !important;
          > div {
            width: fit-content !important;
            display: grid !important;
            grid-template-columns: 1fr 1fr 1fr !important;
            @media (max-width: 768px) {
              grid-template-columns: 1fr 1fr !important;
            }
            > div {
              display: flex !important;
              > a {
                white-space: nowrap !important;
                padding: 0.5rem 1rem !important;
              }
            }
          }
        }
      }
    }
  }
  // Teacher adds new student to the course page.
  &#page-enrol-edu-manage {
    form {
      .form-group {
        @apply m-0 mb-4 flex flex-col #{!important};
        // Required students credentials warnings.
        > :nth-child(1) {
          @apply items-center gap-2 p-0 mb-2 #{!important};
          [class*="label"] {
            @apply p-0 #{!important};
          }
          > :nth-child(2) {
            @apply m-0 #{!important};
          }
        }
        // Credentials inputs.
        > :nth-child(2) {
          @apply m-0 p-0 #{!important};
          input {
            &.is-invalid {
              @apply [background-image:none] #{!important};
            }
          }
        }
      }
      .fdescription {
        @apply mb-4 #{!important};
      }
    }
  }
  // Teacher adds single student page.
  &#page-enrol-single-index {
    form {
      br {
        @apply hidden #{!important};
      }
      // Fieldsets.
      > :nth-child(1),
      > :nth-child(2):not(script) {
        @apply block #{!important};
        label {
          @apply mb-2 #{!important};
        }
        input {
          @apply block #{!important};
        }
      }
      > :nth-child(1) {
        @apply mb-2 #{!important};
      }
      > :nth-child(2) {
        @apply mb-6 #{!important};
      }
      // Next.
      input[type="submit"] {
        @include importantButton;
        @apply h-10 inline-flex py-0 #{!important};
      }
      // New search.
      a[href=""] {
        @apply h-10 inline-flex items-center px-3 rounded-lg border-2 border-gray-900 hover:border-gray-800 #{!important};
      }
      // List of all found students to add.
      table#users-tmpl-container td.fullname label {
        @apply flex items-center gap-2 m-0 #{!important};
      }
    }
  }
  // CONFIRM TEST
  // &#page-mod-quiz-summary,
  // &#page-mod-quiz-view,
  // &#page-user-edit,
  // &#page-mod-assign-editsubmission {
  .moodle-dialogue {
    // HEADER
    [class*="hd"] {
      @apply text-gray-300 font-medium p-0 #{!important};
      h1 {
        @apply font-medium #{!important};
      }
      button {
        &::after {
          @apply text-xl #{!important};
        }
      }
    }
    .moodle-dialogue-wrap {
      @apply bg-transparent #{!important};
    }
    .moodle-dialogue-bd {
      @apply w-auto p-0 #{!important};
      .confirmation-dialogue {
        @apply flex flex-col gap-4 #{!important};
        .confirmation-message {
          @apply m-0 #{!important};
        }
        .confirmation-buttons {
          @apply flex flex-row-reverse mt-4 justify-end gap-4 self-end w-auto items-center #{!important};
          input {
            @apply w-fit py-3 px-6 #{!important};
          }
        }
      }
    }
  }
  // }
  //TEACHER REVIEWS STDENTS TEST / WORK
  &#page-mod-quiz-review {
    [id*="question"] {
      .answer {
        td.control {
          @apply gap-4 flex items-center #{!important};
          > * {
            @apply m-0 #{!important};
          }
        }
      }
      .history {
        @apply border-none #{!important};
      }
    }
  }
  // CALENDAR PAGE
  &#page-calendar-view {
    [data-type="event"] .calendar_event_course {
      @apply bg-rose-500/10 text-rose-500 rounded-t-lg border-none #{!important};
    }
  }
  // Grades of students overview.
  &#page-grade-report-grader-index {
    .gradeparent {
      @apply grid overflow-x-auto #{!important};
      > [role="presentation"] {
        @apply hidden #{!important};
      }
    }
  }
  // TEACHER STUDENTS GROUPS OVERVIEW // LIST OF STUDENTS IN A GROUP
  &#page-blocks-mygroups-overview {
    .controls {
      @apply flex items-center gap-2 #{!important};
      > .pix-box {
        @apply gap-2 flex-row flex #{!important};
        > a {
          @apply p-0 #{!important};
          > img {
            @apply hidden #{!important};
          }
        }
      }
    }
    .legend-box {
      @apply hidden #{!important};
    }
    table#group-overview {
      td.c0 {
        // STUDENT PROFILE PICTURE
        > a {
          > img {
            @apply m-0 #{!important};
          }
        }
        // WRITE MESSAGE / GRADES
        > :nth-child(2) {
          @include card;
          @apply mt-2 flex bg-transparent #{!important};
          > a {
            @apply relative w-8 h-8 #{!important};
            &:is(:hover, :focus, :active) {
              &::after {
                @apply bg-gray-400 #{!important};
              }
            }
            > img,
            > i {
              @apply hidden #{!important};
            }
            &::after {
              @apply content-[""] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-gray-400 #{!important};
            }
            &[href*="message"] {
              &::after {
                mask: url("chrome-extension://__MSG_@@extension_id__/assets/comment-solid.svg");
              }
            }
            &[href*="grade"] {
              &::after {
                mask: url("chrome-extension://__MSG_@@extension_id__/assets/table-solid.svg");
              }
            }
          }
        }
      }
      // CELLS
      .progressbox {
        td {
          padding: 0 !important;
        }
        tr:has(> td.cm) {
          > td {
            @include cell;
          }
        }
      }
      // COMPLETED PERCENTAGE
      td.c3 {
        @apply font-bold px-8 #{!important};
      }
    }
  }
  // Teacher grading the work of a student.
  &#page-mod-assign-grader {
    #page {
      #page-content {
        [role="main"] {
          @apply h-screen grid grid-cols-[2fr_1fr] grid-rows-[min-content_1fr_min-content] #{!important};
          #user-notifications,
          #maincontent {
            @apply hidden #{!important};
          }
          // Top panel.
          [data-region="grading-navigation-panel"] {
            @apply flex h-fit relative col-span-2 #{!important};
            .container-fluid {
              @apply p-0 flex h-fit justify-center #{!important};
              [data-region="grading-navigation"] {
                @apply py-2 px-4 bg-gray-925 flex grow h-fit items-center m-0 #{!important};
                [data-region="assignment-info"] {
                  @apply p-0 #{!important};
                }
                [data-region="user-info"] {
                  @apply flex h-fit #{!important};
                  > h4 {
                    @apply text-ellipsis m-0 #{!important};
                    a {
                      @apply flex items-center gap-3 #{!important};
                      img {
                        @apply w-10 h-10 rounded-full m-0 #{!important};
                      }
                      em {
                        @apply hidden #{!important};
                      }
                    }
                  }
                }
                [data-region="user-selector"] {
                  @apply p-0 flex #{!important};
                  .alignment {
                    @apply m-0 grid grid-cols-[min-content_1fr_min-content] gap-2 flex-1 relative #{!important};
                    br,
                    select {
                      @apply hidden #{!important};
                    }
                    a[href="#previous"],
                    a[href="#next"] {
                      @apply flex m-0 items-center justify-center h-10 w-10 rounded-lg bg-gray-900 hover:bg-gray-800 #{!important};
                    }
                    [data-region="input-field"] {
                      @apply relative #{!important};
                      div:has(> input.form-control) {
                        @apply flex m-0 #{!important};
                        input.form-control {
                          @apply pr-10 m-0 w-0 grow #{!important};
                        }
                        [id*="form_autocomplete_downarrow"] {
                          @apply top-1/2 right-2 -translate-y-1/2 w-6 h-6 flex items-center justify-center text-gray-500 hover:text-gray-200 rounded-lg #{!important};
                        }
                      }
                    }
                    [data-region="user-count"] {
                      @apply col-start-2 flex items-center justify-center #{!important};
                    }
                    // Filters popup position.
                    [data-region="configure-filters"] {
                      @apply top-full -translate-y-1/3 right-0 #{!important};
                    }
                    a[data-region="user-filters"] {
                      @apply w-10 h-10 flex items-center justify-center border-2 border-gray-900 hover:border-gray-800 #{!important};
                      i {
                        @apply m-0 #{!important};
                      }
                    }
                    ul.form-autocomplete-suggestions {
                      @include card;
                      @include shadow;
                      @include smoothAppearAnim;
                      @apply p-2 m-0 top-full #{!important};
                      li {
                        @apply text-gray-400 hover:text-gray-200 shadow-none hover:bg-gray-800 rounded-lg px-2 py-1 #{!important};
                        &[aria-selected="true"] {
                          @apply bg-gray-700 pointer-events-none text-gray-200 #{!important};
                        }
                        * {
                          @apply text-sm #{!important};
                        }
                      }
                    }
                  }
                }
              }
            }
          }
          // Main.
          // Review panel with a canvas.
          [data-region="review-panel"] {
            @apply relative inset-0 overflow-y-auto #{!important};
            .warningmessages {
              @apply hidden #{!important};
            }
            .drawingregion {
              @apply relative inset-0 #{!important};
            }
            // Editing tools.
            .pageheader {
              @apply bg-transparent h-auto border-none p-4 flex-wrap flex items-center gap-2 #{!important};
              .navigation {
                @apply h-auto bg-transparent flex m-0 #{!important};
                select {
                  @apply h-10 rounded-none #{!important};
                }
                .navigate-previous-button,
                .navigate-next-button {
                  @apply h-10 w-10 bg-gray-800 rounded-lg hover:[background-image:none] hover:bg-gray-700 flex items-center justify-center #{!important};
                  img {
                    @apply m-0 #{!important};
                  }
                }
                .navigate-next-button {
                  @apply rounded-l-none #{!important};
                }
                .navigate-previous-button {
                  @apply rounded-r-none #{!important};
                }
              }
              .navigation-search,
              .navigation-expcol {
                @apply m-0 h-auto bg-transparent #{!important};
                button {
                  @apply bg-gray-800 h-10 aspect-square hover:[background-image:none] hover:bg-gray-700 p-0 flex items-center justify-center #{!important};
                  img {
                    @apply m-0 p-0 w-4 h-4 #{!important};
                  }
                }
              }
              .toolbar_group {
                @apply inline-flex gap-2 #{!important};
                .toolbar {
                  @apply m-0 rounded-lg bg-gray-800 flex h-10 #{!important};
                  button {
                    @apply hover:[background-image:none] hover:bg-gray-700 aspect-square flex-none h-auto p-0 flex items-center justify-center #{!important};
                    // Selected tool.
                    &[aria-pressed="true"] {
                      @apply [background-image:none] bg-gray-700 pointer-events-none #{!important};
                    }
                    img {
                      @apply m-0 w-4 h-4 p-0 #{!important};
                    }
                  }
                }
              }
            }
          }
          // Grade panel.
          [data-region="grade-panel"] {
            @apply relative w-auto p-4 inset-0 overflow-y-auto bg-gray-900 rounded-lg #{!important};
            [data-region="grade"] {
              // Student's submission.
              > .submissionstatustable {
                .assignsubmission {
                  @apply mt-4 rounded-lg border-2 border-gray-800 #{!important};
                  > div {
                    @apply p-2 #{!important};
                  }
                }
                .submissionstatussubmitted,
                .earlysubmission {
                  @apply py-1 px-2 rounded-lg bg-emerald-500/10 text-emerald-500 my-2 #{!important};
                }
                .latesubmission {
                  @apply py-1 px-2 rounded-lg bg-rose-500/10 text-rose-500 my-2 #{!important};
                }
              }
              // Teacher grade input.
              #fitem_id_grade {
                @include card;
                @apply p-2 #{!important};
              }
              #fitem_id_currentgrade {
                @include card;
                @apply bg-transparent p-2 #{!important};
              }
              #fitem_id_assignfeedbackcomments_editor {
                @apply p-0 mt-4 bg-transparent #{!important};
                &.popout {
                  @include card;
                  @include shadow;
                  @include smoothAppearAnim;
                  padding: 1rem !important;
                }
                [data-fieldtype="editor"] {
                  @include card;
                  background-color: transparent !important;
                }
              }
              #id_attemptsettings {
                @apply text-sm border-2 border-gray-800 rounded-lg p-2 #{!important};
                legend {
                  @apply font-medium text-gray-300 m-0 w-fit #{!important};
                }
                .fcontainer {
                  @apply p-0 m-0 text-gray-400 #{!important};
                }
              }
            }
          }
          // Bottom panel.
          [data-region="grade-actions-panel"] {
            @apply bg-gray-925 col-span-2 relative h-auto #{!important};
            // Align buttons.
            .collapse-buttons {
              display: none !important;
            }
            form {
              @apply flex items-center justify-end #{!important};
              label {
                @apply flex items-center gap-2 m-0 #{!important};
                & + a {
                  @apply ml-2 #{!important};
                }
              }
              button {
                @apply items-center flex py-2 #{!important};
                &[name="savechanges"] {
                  @apply ml-8 #{!important};
                }
                &[name="saveandshownext"],
                &[name="resetbutton"] {
                  @apply ml-2 #{!important};
                }
              }
            }
          }
        }
      }
    }
  }
  // TEACHER SEES STUDENTS GROUPS IN A COURSE IN THE SIDE SECTION
  section.block_mygroups {
    div:has(> .course-group-box) {
      @apply flex gap-4 flex-wrap #{!important};
      > .title {
        @apply hidden #{!important};
      }
      > .course-group-box {
        @include card;
        @apply w-full gap-2 p-2 m-0 flex-col bg-transparent #{!important};
        > * {
          @apply m-0 #{!important};
        }
        > .group-completeness {
          @apply flex flex-nowrap gap-2 items-center m-0 #{!important};
          // PERCENTAGE
          > .completeness-value {
            @apply text-center w-16 #{!important};
          }
          // SLIDER CONTAINER
          > .group-completion-bar-box {
            @apply m-0 grow #{!important};
          }
        }
      }
      > div:has(> a) {
        @apply inline-flex m-0 w-fit #{!important};
        > a {
          @apply m-0 #{!important};
          > img {
            @apply hidden #{!important};
          }
        }
      }
    }
  }
}
.bar-frame {
  @apply bg-purple-500/20 rounded-sm overflow-hidden h-2 #{!important};
  > .bar-fill {
    @apply relative bg-purple-500/50 overflow-hidden #{!important};
    &::after {
      animation: glare 5s infinite forwards linear !important;
      left: 50%;
      @apply content-[""] w-20 h-20 top-1/2 -translate-x-1/2 rounded-full blur-[1rem] absolute bg-purple-500 #{!important};
      @keyframes glare {
        0% {
          left: calc(0% - 5rem) !important;
        }
        100% {
          left: calc(100% + 5rem) !important;
        }
      }
    }
  }
}
// MODAL
.yui3-widget.yui3-panel,
.moodle-dialogue,
.yui3-widget-modal,
.modal-dialog {
  @include card;
  @include smoothAppearAnim;
  @include shadow;
  @apply fixed max-h-[calc(100vh-4rem)] overflow-y-auto top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 max-w-screen-md w-[calc(100vw-2rem)] h-fit bg-gray-925 p-4 #{!important};
  [role="dialog"].moodle-dialogue-content {
    @apply bg-transparent p-0 relative #{!important};
    .moodle-dialogue-hd {
      @apply flex items-center min-h-0 #{!important};
      h3 {
        @apply m-0 #{!important};
      }
      button.closebutton {
        @apply p-0 w-10 h-10 m-0 border-gray-900 border-2 rounded-lg flex items-center justify-center #{!important};
        &::after {
          @apply text-2xl #{!important};
        }
      }
    }
    .moodle-dialogue-bd {
      @apply overflow-auto mt-4 #{!important};
    }
  }
  .modal-content {
    @apply p-0 bg-transparent #{!important};
    .modal-header,
    .modal-body,
    .modal-footer {
      @apply p-0 #{!important};
    }
    .modal-header {
      h5 {
        @apply text-gray-200 #{!important};
      }
      button.close {
        @apply flex w-10 h-10 font-normal [text-shadow:none] items-center justify-center border-solid opacity-100 border-2 border-gray-900 hover:border-gray-800 #{!important};
        span {
          @apply hidden #{!important};
        }
        &::after {
          @apply content-["\2573"] text-gray-300 #{!important};
        }
      }
    }
  }
}
// UPLOAD FILE FORM BLOCK (NOT MODAL)
.filemanager {
  @include card;
  @apply p-4 flex flex-col gap-4 border-2 border-gray-900 #{!important};
  .fp-restrictions * {
    @apply text-gray-500 text-sm #{!important};
  }
  .fp-navbar {
    @apply hidden #{!important};
  }
  .filemanager-container {
    @apply outline-none shadow-none h-auto overflow-hidden hover:border-purple-500 duration-100 bg-gray-950 #{!important};
    // When dragging into a file.
    &.dndupload-over {
      @apply outline outline-2 outline-purple-500 #{!important};
    }
    // No files uploaded yet, please select files, file selection container.
    .fm-empty-container {
      @apply inset-0 h-44 static p-0 top-3 text-gray-200 #{!important};
      .dndupload-message {
        @apply block text-sm mt-3  #{!important};
        .dndupload-arrow {
          @apply inset-0 pt-3 cursor-pointer object-contain h-auto [background-image:none] flex items-center justify-center #{!important};
          &::after {
            animation: file 1s infinite alternate ease-in-out;
            @apply content-[""] h-20 w-20 bg-cover bg-center bg-[url(https://imgur.com/jDaGVzD.png)] #{!important};
            @keyframes file {
              from {
                translate: 0 0;
                opacity: 1;
              }
              to {
                translate: 0 0.2rem;
                opacity: 0.5;
              }
            }
          }
        }
      }
    }
    .fm-content-wrapper {
      @apply h-full #{!important};
      // File or files uploaded, display files.
      .fp-content {
        @apply p-3 #{!important};
        .fp-iconview {
          @apply grid gap-3 grid-cols-[repeat(auto-fill,minmax(8rem,1fr))] #{!important};
          .fp-file {
            @apply p-2 m-0 float-none #{!important};
            &:hover .fp-thumbnail {
              @apply bg-gray-800 #{!important};
              img {
                @apply scale-110 #{!important};
              }
            }

            // File icon.
            .fp-thumbnail {
              @apply min-h-0 min-w-0 border-none w-auto h-auto p-2 aspect-square bg-gray-900 rounded-full flex items-center justify-center duration-100 #{!important};
              img {
                @apply min-w-0 min-h-0 max-w-none max-h-none border-none h-1/2 aspect-square rounded-lg p-0 duration-200 #{!important};
              }
            }
            // File name.
            .fp-filename-field {
              @apply h-auto m-0 overflow-auto static mt-2 #{!important};
              .fp-filename {
                @apply w-auto p-0 min-w-0 bg-transparent text-sm #{!important};
              }
            }
          }
        }
      }
    }
    .dndupload-target {
      @apply hidden #{!important};
    }
    .fp-upload-form {
      input,
      div {
        @apply rounded-lg py-3 px-8 bg-gray-925 #{!important};
      }
    }
  }
}
// UPLOAD FILE MODAL
.moodle-dialogue.filepicker {
  .col-md-9 {
    @apply flex-auto #{!important};
  }
  .moodle-dialogue-bd {
    .container {
      @apply p-0 w-auto m-0 max-w-none #{!important};
      .file-picker.fp-generallayout {
        @apply p-0 flex m-0 gap-4 flex-nowrap max-md:flex-col #{!important};
        .fp-repo-area {
          @apply gap-2 p-0 bg-transparent min-w-[20ch] #{!important};
          .nav-link {
            @apply px-2 py-1 rounded-lg bg-gray-900 #{!important};
            &.active {
              @apply bg-gray-800 #{!important};
            }
            img {
              @apply hidden #{!important};
            }
          }
        }
        .fp-repo-items {
          .fp-navbar {
            @apply hidden #{!important};
          }
          .fp-content.card {
            @apply p-4 shadow-none h-auto outline-none #{!important};
            .fp-formset {
              @apply p-0 #{!important};
              .form-group {
                @apply flex-col items-start #{!important};
              }
            }
          }
          // CHOOSE FILE INPUT
          .fp-file div:nth-child(2) {
            @apply p-0 #{!important};
            input {
              @include pulseAnim;
              @apply w-full p-4 #{!important};
              &::-webkit-file-upload-button {
                @apply hidden #{!important};
              }
              &:hover {
                @apply cursor-pointer #{!important};
              }
            }
          }
          .fp-upload-btn {
            @include importantButton;
          }
        }
      }
    }
  }
}
// GRADES
.submissionsummarytable table,
.submissionstatustable {
  // NOT GRADED
  .submissionnotgraded {
    @apply text-gray-200 font-bold #{!important};
  }
  // GRADED
  .submissiongraded {
    @apply font-bold text-emerald-500 #{!important};
  }
  // COMMENT
  .comment-area {
    @include card;
    @apply bg-transparent p-2 m-0 mt-4 #{!important};
  }
}
// JUMP TO ACTIVITY
// SUBMIT / RESUBMIT
div.submissionaction button {
  @include importantButton;
}
// Messenger.
.message-app,
.message-app.bg-light {
  @include card;
  @include shadow;
  @apply flex flex-col flex-nowrap gap-2 bg-gray-925 border-none p-4 #{!important};
  // Bandges, new messages, new contacts requests.
  [data-region="contact-request-count"],
  [data-region*="unread-count"] {
    @include notificationBadge;
  }
  // Textarea, write a message.
  [data-region="content-messages-footer-container"] {
    @apply p-0 mt-8 #{!important};
    > :nth-child(1) {
      @apply m-0 #{!important};
      textarea {
        @include card;
        @apply bg-gray-950 p-2 flex-1 #{!important};
      }
      button[data-action="send-message"] {
        @apply m-0 ml-2 justify-self-center flex-1 bg-gray-900 hover:bg-gray-800 #{!important};
      }
    }
  }
  // TWO SIDES MESSENGER
  .container-fluid {
    @apply flex h-full p-0 flex-nowrap flex-col #{!important};
    > div:nth-child(1) {
      @apply flex flex-row flex-nowrap gap-4 #{!important};
      > div {
        @apply p-0 #{!important};
      }
      // LEFT SIDE
      > div:nth-child(1) {
        > div:nth-child(1) {
          @apply flex flex-col flex-nowrap gap-4 #{!important};
        }
      }
      // RIGHT SIDE
      > div:nth-child(2) {
        @apply flex flex-1 gap-2 #{!important};
      }
    }
  }
  // Messenger header.
  [class*="header-container"] {
    [data-route-back],
    [data-route="view-search"] {
      @apply rounded-lg w-10 h-10 shrink-0 flex items-center justify-center m-0 border-2 border-gray-900 hover:border-gray-800 border-solid #{!important};
      i {
        @apply text-gray-300 hover:text-gray-200 #{!important};
      }
    }
    div[data-region*="view"] {
      @apply mb-2 p-0 #{!important};
      &[data-region="view-overview"] {
        @apply flex flex-row flex-wrap p-0 items-center gap-2 #{!important};
        > :nth-child(1) {
          @apply flex items-center flex-1 gap-2 #{!important};
          .input-group.simplesearchform {
            // Search user icon.
            .input-group-append {
              @apply hidden #{!important};
            }
          }
          // Messenger settings button.
          > :nth-child(2) {
            @apply m-0 #{!important};
            a[data-route="view-settings"] {
              @apply w-10 h-10 bg-gray-900 hover:bg-gray-800 flex items-center justify-center #{!important};
            }
          }
        }
        > :nth-child(2) {
          @apply m-0 #{!important};
          // See contacts list button.
          a[data-route="view-contacts"] {
            @include importantButton;
            @apply gap-4 h-10 #{!important};
          }
        }
      }
      // All Contacts toolbar, settings toolbar.
      &[data-region="view-contacts"],
      &[data-region="view-settings"] {
        > :nth-child(1) {
          @apply gap-4 #{!important};
          > :nth-child(2) {
            @apply text-gray-300 #{!important};
          }
        }
      }
      // Current chat toolbar.
      &[data-region="view-conversation"] {
        @apply p-0 mb-2 #{!important};
        > [data-region="header-content"] {
          > div:nth-child(1) {
            @apply flex gap-4 #{!important};
            // Person in the messenger header.
            a[data-action="view-contact"] {
              @apply flex items-center #{!important};
              // Profile picture.
              > :nth-child(1) {
                @apply w-10 h-10 #{!important};
                img {
                  @apply h-auto w-auto #{!important};
                }
              }
              // Favourite contact star.
              span[data-region="favourite-icon-container"] {
                @apply text-purple-500 #{!important};
              }
              // Name, surname, middlename.
              > :nth-child(2) {
                @apply ml-4 font-["Finlandica"] font-normal #{!important};
                *:not(.fa-star) {
                  @apply font-[inherit] #{!important};
                }
              }
            }
            // Button more options in the chat.
            > div:nth-child(3) {
              button {
                @apply border-2 w-10 h-10 border-solid border-gray-900 hover:border-gray-800 rounded-lg flex items-center justify-center #{!important};
              }
            }
          }
        }
        [data-region="header-edit-mode"] {
          > :nth-child(1) {
            @apply p-0 #{!important};
            button[data-action="cancel-edit-mode"] {
              @apply flex w-10 h-10 font-normal [text-shadow:none] items-center justify-center border-solid opacity-100 border-2 border-gray-900 hover:border-gray-800 #{!important};
              span {
                @apply hidden #{!important};
              }
              &::after {
                @apply content-["\2573"] text-gray-300  #{!important};
              }
            }
          }
        }
      }
      // Search users toolbar.
      &[data-region="view-search"] {
        > :nth-child(1) {
          @apply gap-2 #{!important};
          .input-group-append {
            @apply ml-2 #{!important};
            button[data-action="search"] {
              @apply w-10 h-10 flex items-center justify-center border-2 border-solid border-gray-900 hover:border-gray-800 #{!important};
            }
          }
        }
      }
    }
  }
  // Contacts, contact groups in the messenger menu.
  [class*="body-container"] {
    overflow: visible !important;
    [class*="view-overview-body"] {
      overflow: visible !important;
      [id*="message-drawer-view-overview-container"] {
        @include card;
        @apply bg-gray-950 flex flex-col flex-nowrap overflow-visible p-2 #{!important};
        // Contacts group
        .section.card {
          @apply bg-none shadow-none outline-none #{!important};
          button[data-toggle="collapse"] {
            .collapsed-icon-container,
            .expanded-icon-container {
              @apply text-gray-500 w-2 text-center #{!important};
            }
            // Group name.
            > :nth-child(3) {
              @apply ml-2 #{!important};
            }
            small {
              @apply ml-2 text-gray-500 #{!important};
            }
          }
          // Contact button, open chat with a contact.
          a[data-user-id] {
            @apply p-2 rounded-lg hover:bg-gray-800 #{!important};
            img {
              @apply m-0 aspect-square h-12 #{!important};
            }
            :nth-child(2) {
              @apply m-0 ml-3 #{!important};
              .last-message {
                @apply m-0 #{!important};
              }
            }
            [data-region="last-message-date"] {
              @apply p-0 top-2 right-2 text-sm #{!important};
            }
            :has(> .dir-rtl-hide, > .dir-ltr-hide) {
              @apply hidden #{!important};
            }
          }
        }
      }
    }
    // Chat in messenger.
    [data-region="view-conversation"] {
      @apply p-0 #{!important};
      // MESSAGES CONTAINER
      .content-message-container {
        @apply p-0 #{!important};
        // Day in chat.
        [data-region="day-container"] {
          @apply flex flex-col items-center #{!important};
          // Date.
          > h6 {
            @apply mx-4 py-1 px-4 text-sm rounded-full outline-2 outline-gray-800 w-fit text-gray-400 #{!important};
          }
          // List of messages during the day.
          > div {
            @apply rounded-lg self-stretch gap-2 #{!important};
            // Every message.
            .message {
              @apply p-2 text-sm m-0 rounded-lg #{!important};
              &.received {
                @apply bg-gray-900 text-gray-200 mr-[15%] #{!important};
              }
              &.send {
                @apply bg-transparent border-2 ml-[15%] border-solid border-gray-800 text-gray-400 #{!important};
              }
              .time {
                @apply text-sm text-gray-500 #{!important};
              }
              // Text in every message.
              // [data-region="text-container"]:has(:nth-last-child(2):is(br)) {
              //   @apply overflow-y-hidden #{!important};
              //   p {
              //     @apply mb-[-3lh] #{!important};
              //   }
              //   > *:last-child():is(br) {
              //     @apply hidden #{!important};
              //   }
              // }
            }
          }
        }
      }
      // WHITE BACKGROUND IN CHAT WHILE LOADING / DIALOGUE PLACEHOLDER IN CHAT
      [data-region="content-placeholder"] {
        display: none !important;
      }
      // CONFIRM DIALOGUE ADD TO CONTACTS
      [data-region="confirm-dialogue"] {
        @include card;
        @include shadow;
        @include smoothAppearAnim;
        button {
          @include importantButton;
        }
      }
    }
    // Contacts and requests tab.
    &.body-container:has([data-region="view-contacts"]:not([aria-hidden="true"])) {
      [data-region="view-contacts"] {
        overflow: visible !important;
        > div:nth-child(1) {
          @include card;
          overflow: hidden !important;
          // Contants and requests tab buttons.
          div:has(> ul) {
            @apply p-0 #{!important};
            > ul {
              @apply flex flex-nowrap m-0 bg-transparent #{!important};
              > li {
                @apply flex-1 #{!important};
                > a {
                  @apply bg-transparent rounded-none m-0 hover:bg-gray-900 #{!important};
                  &.active {
                    @apply bg-gray-800 #{!important};
                  }
                }
                &:first-child a {
                  @apply rounded-l-lg #{!important};
                }
                &:last-child a {
                  @apply rounded-r-lg #{!important};
                }
              }
            }
          }
          // Contacts list.
          .tab-content {
            @apply bg-transparent mt-4 #{!important};
            // Contacts.
            .list-group[data-region="content-container"] {
              > a {
                @apply rounded-lg p-2 gap-3 hover:bg-gray-800 items-center #{!important};
                h6 {
                  @apply m-0 #{!important};
                }
              }
            }
          }
        }
      }
    }
  }
  *,
  *[class*="border"] {
    border: none !important;
  }
  .bg-white {
    background-color: transparent !important;
  }
}
// QUIZ / TESTS / ATTEMPTS / QUESTION STATUS BUTTONS / FINISH TEST
// QUESTION STATUS BUTTONS
div.qn_buttons {
  @apply flex flex-wrap #{!important};
  a.qnbutton {
    @apply rounded-lg overflow-hidden bg-gray-950 hover:brightness-125 #{!important};
    &.thispage {
      @apply outline outline-2 outline-gray-800 #{!important};
    }
    &.notyetanswered {
      .trafficlight {
        @apply bg-transparent #{!important};
      }
    }
    &.answersaved {
      .trafficlight {
        @apply bg-gray-800 #{!important};
      }
    }
    &.incorrect {
      outline: 0.1rem solid hsl(20, 100%, 40%) !important;
    }
  }
}
.othernav {
  a {
    width: fit-content !important;
    padding: 0.5rem !important;
  }
  a.endtestlink,
  a.mod_quiz-next-nav {
    @include importantButton;
  }
}

div.quizattempt button {
  @include importantButton;
}
// MODAL POPUP START TEST/QUIZ TIME LIMITED WARNING
form#mod_quiz_preflight_form {
  padding: 1rem !important;
  fieldset[id="id_honestycheckheader"] {
    margin: 0 !important;
    & > :nth-child(1) {
      padding: 0 !important;
    }
  }
  div[id="fitem_id_honestycheckmessage"] {
    margin: 0 !important;
    // EMPTY BLOCK WTF???
    & > div:nth-child(1) {
      display: none !important;
    }
    & > div:nth-child(2) {
      padding: 0 !important;
      max-width: unset !important;
      flex: unset !important;
    }
  }
  div[id="fgroup_id_buttonar"] {
    @apply flex flex-row justify-end p-0 mt-8 #{!important};
    // EMPTY BLOCK WTF???
    & > :nth-child(1) {
      display: none !important;
    }
    // BUTTONS
    & > :nth-child(2) {
      @apply p-0 max-w-[unset] flex-[unset] w-fit #{!important};
      .d-flex.flex-wrap.align-items-center {
        @apply flex-nowrap gap-2 #{!important};
        .form-group {
          @apply m-0 #{!important};
        }
      }
    }
  }
}
// TEST
#quiztimer {
  @apply bg-gray-925 h-12 rounded-lg flex items-center px-3 text-gray-400 #{!important};
  #quiz-time-left {
    @apply text-gray-200 font-medium #{!important};
  }
}
[id*="question"] {
  .info {
    @apply bg-transparent #{!important};
    .no {
      @apply font-medium text-gray-300 #{!important};
    }
    .state,
    .grade {
      @apply text-sm #{!important};
    }
    .questionflag {
      @apply hidden #{!important};
    }
  }
  .formulation {
    @apply p-4 bg-transparent text-gray-400 rounded-lg bg-gray-950 #{!important};
    .ablock {
      @apply inline-flex flex-col gap-4 #{!important};
      // ANSWER IN TEST
      .answer {
        @include card;
        @include shadow;
        @apply w-fit overflow-hidden #{!important};
        // IF TABLE
        > tbody {
          > tr {
            &:first-child {
              > td {
                @apply pt-4 #{!important};
              }
            }
            &:last-child {
              > td {
                @apply pb-4 #{!important};
              }
            }
            > td {
              @apply py-2 px-4 #{!important};
              p {
                @apply m-0 #{!important};
              }
            }
          }
        }
        // CHECKBOX / RADIO BUTTON LEFTSIDE ANSWER
        input[type="radio"],
        input[type="checkbox"] {
          @apply hidden #{!important};
        }
        // EACH ANSWER OPTION
        & > div {
          @apply m-0 flex flex-nowrap items-center hover:bg-gray-900 text-gray-400 #{!important};
          &:has(input:checked) {
            @apply bg-gray-800 #{!important};
            // ANSWER TEXT
            [data-region="answer-label"] {
              // TEXT INSIDE
              * {
                @apply text-gray-200 #{!important};
              }
            }
            label {
              @apply text-gray-400 flex-1 #{!important};
            }
          }
          div[data-region="answer-label"],
          label {
            @apply flex items-center pr-8 pl-3 py-2 cursor-pointer m-0 #{!important};
            * {
              @apply m-0 #{!important};
            }
          }
        }
      }
      [id*="clearchoice"] {
        input {
          @apply hidden #{!important};
        }
        a {
          @apply m-0 rounded-lg border-2 border-gray-900 hover:border-gray-800 #{!important};
        }
      }
    }
  }
}
// FINISH TEST / RETURN TO TEST / CONFIRM TEST / REVIEW QUIZ TEST
div.submitbtns {
  @apply flex flex-row justify-end gap-4 h-auto w-auto #{!important};
  button,
  a {
    @include importantButton;
  }
}
table.quizattemptsummary {
  a[title^="Просмотр"] {
    @include importantButton;
  }
}
// TEST REVIEW / RESULTS
form[action*="review"] {
  // CORRENT AND INCORRECT ICONS
  i {
    @apply m-2 #{!important};
  }
  table.answer {
    * {
      @apply m-0 #{!important};
    }
    td {
      @apply py-2 px-4 #{!important};
      &.control {
        @apply flex items-center flex-nowrap gap-4 #{!important};
      }
    }
  }
  .form-inline {
    @apply items-start #{!important};
    & > label {
      @apply inline-flex gap-4 #{!important};
      span.answer {
        @apply w-fit inline-flex #{!important};
        input {
          @apply w-40 #{!important};
        }
      }
    }
  }
}
